
## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –®–∞–≥ 1: –°–µ—Ç–∞–ø –ø—Ä–æ–µ–∫—Ç–∞ (–ª–æ–∫–∞–ª—å–Ω–æ)

1. **–ß–µ—Ä–µ–∑ GitHub Desktop (–¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤):**
   - –°–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [GitHub Desktop](https://desktop.github.com/)
   - –ù–∞–∂–º–∏—Ç–µ "Clone a repository from the Internet"
   - –í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
   - –í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–ø–∫—É –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

2. **–ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É:**
   ```bash
   git clone git@github.com:NesterNN/cosmetology-bot-backend.git
   cd cosmetology-bot-backend
   ```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è. –í–ê–ñ–ù–û: —ç—Ç–æ—Ç —ç—Ç–∞–ø –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞, –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å - –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å


```bash
# Windows
python -m venv .venv
c:/path/to/folder/cosmetology-bot-backend/.venv/Scripts/Activate.ps1

# Mac/Linux
python -m venv .venv
source .venv/bin/activate
```

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è `(.venv)`.

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤ –Ω–µ–≥–æ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–±–ª–æ–Ω:

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
DATABASE_URL=postgresql://username:password@localhost:5432/database_name

# Redis –¥–ª—è –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
REDIS_URL=redis://localhost:6379

# API –∫–ª—é—á–∏ Claude AI
CLAUDE_API_KEY_1=key1
CLAUDE_API_KEY_2=key2

# Google Sheets –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
GOOGLE_CREDENTIALS_FILE=credentials.json
GOOGLE_SHEET_ID=id_—Ç–∞–±–ª–∏—Ü—ã

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
DEBUG=True
HOST=0.0.0.0
PORT=8000
```

### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –ø—Ä–æ–µ–∫—Ç–∞ (—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã –∏ —É—Å–ª—É–≥–∏)

1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `local_config.json` –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ –Ω–µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `local_config.example.json`
2. –ó–∞–º–µ–Ω–∏—Ç—å —É—Å–ª—É–≥–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞
3. –í —Å–ª—É—á–∞–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ - –º–µ–Ω—è—Ç—å –∏–º–µ–Ω–Ω–æ —Ñ–∞–π–ª `local_config.json` - –ù–ï –¢–†–û–ì–ê–¢–¨ .py –§–ê–ô–õ–´.

### –®–∞–≥ 6: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤. –í–ê–ñ–ù–û: —ç—Ç–æ—Ç —ç—Ç–∞–ø –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å, –µ—Å–ª–∏ –Ω–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ

#### üóÑÔ∏è PostgreSQL (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
1. –°–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [PostgreSQL](https://www.postgresql.org/download/)
2. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:
   ```sql
   CREATE DATABASE cosmetology_bot;
   CREATE USER bot_user WITH PASSWORD '–≤–∞—à_–ø–∞—Ä–æ–ª—å';
   GRANT ALL PRIVILEGES ON DATABASE cosmetology_bot TO bot_user;
   ```

#### üîß Redis (–æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π)
1. **Windows:** –°–∫–∞—á–∞–π—Ç–µ [Redis for Windows](https://github.com/MicrosoftArchive/redis/releases)
2. **Mac:** `brew install redis`
3. **Linux:** `sudo apt install redis-server`

#### üìä Google Sheets
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
3. –í–∫–ª—é—á–∏—Ç–µ API:
   - Google Sheets API
   - Google Drive API
4. –°–æ–∑–¥–∞–π—Ç–µ Service Account:
   - IAM & Admin ‚Üí Service Accounts ‚Üí Create
   - –°–∫–∞—á–∞–π—Ç–µ JSON —Ñ–∞–π–ª —Å –∫–ª—é—á–∞–º–∏
   - –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –≤ `credentials.json`
5. –°–æ–∑–¥–∞–π—Ç–µ Google –¢–∞–±–ª–∏—Ü—É –∏ –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å –µ–π —Å email –∏–∑ Service Account

---

## üöÄ –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

### –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—É—Å–∫

```bash
python start.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –°–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ó–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–µ—Ä

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

### üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
- **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞:** http://localhost:8000
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API:** http://localhost:8000/docs
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è:** http://localhost:8000/health

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### –ì–ª–∞–≤–Ω—ã–µ —Ñ–∞–π–ª—ã:
```
cosmetology-bot-backend/
‚îú‚îÄ‚îÄ main.py                 # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ start.py               # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ —Ä—É—á–Ω–æ–º –∑–∞–ø—É—Å–∫–µ)
‚îú‚îÄ‚îÄ requirements.txt       # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
‚îú‚îÄ‚îÄ prompts.yml           # –ü—Ä–æ–º—Ç—ã –¥–ª—è –ö–ª–æ–¥–∞
‚îú‚îÄ‚îÄ .env                  # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞, –ø—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ - `.env-example`
‚îî‚îÄ‚îÄ README.md             # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –ü–∞–ø–∫–∞ `app/` (–æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞):
```
app/
‚îú‚îÄ‚îÄ config.py             # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ database.py           # –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ models.py             # –°—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ services/             # –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:
‚îÇ   ‚îú‚îÄ‚îÄ claude_service.py     # –†–∞–±–æ—Ç–∞ —Å –∫–ª–æ–¥–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ booking_service.py    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ google_sheets.py      # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ message_queue.py      # –û—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π
‚îî‚îÄ‚îÄ utils/
    ‚îî‚îÄ‚îÄ prompt_loader.py  # –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–º—Ç–æ–≤
```

---

## ‚öôÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

### üéØ `main.py` - –°–µ—Ä–¥—Ü–µ —Å–∏—Å—Ç–µ–º—ã
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç SendPulse, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏—Ö —á–µ—Ä–µ–∑ –ö–ª–æ–¥ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç—ã.

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `sendpulse_webhook()` - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å SendPulse
- `process_message_async()` - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ò–ò
- `get_dialogue_history()` - –ø–æ–ª—É—á–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –¥–∏–∞–ª–æ–≥–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º

### üß† `app/services/claude_service.py` - –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ö–ª–æ–¥–æ–º
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —é–∑–µ—Ä–æ–≤

**–ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–º–µ–µ—Ç –≤ —Å–µ–±–µ –∫–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞**

### üìÖ `app/services/booking_service.py` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –°–æ–∑–¥–∞–µ—Ç, –∏–∑–º–µ–Ω—è–µ—Ç –∏ –æ—Ç–º–µ–Ω—è–µ—Ç –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤.

**–§—É–Ω–∫—Ü–∏–∏:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –ü–µ—Ä–µ–Ω–æ—Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π
- –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–µ–π

### üìä `app/services/google_sheets.py` - –†–∞–±–æ—Ç–∞ —Å –≥—É–≥–ª —Ç–∞–±–ª–∏—Ü–µ–π
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å Google –¢–∞–±–ª–∏—Ü–∞–º–∏.

**–§–æ—Ä–º–∞—Ç —Ç–∞–±–ª–∏—Ü—ã:**
```
| –î–∞—Ç–∞     | –ü–æ–ª–Ω–∞—è –¥–∞—Ç–∞ | –í—Ä–µ–º—è | ID –∫–ª–∏–µ–Ω—Ç–∞ | –ò–º—è –∫–ª–∏–µ–Ω—Ç–∞ | –£—Å–ª—É–≥–∞      |
|----------|-------------|-------|------------|-------------|-------------|
| 25.01    | 25.01.2025  | 14:00 | 123456789  | –ê–Ω–Ω–∞        | –ß–∏—Å—Ç–∫–∞ –ª–∏—Ü–∞ |
```

### üîÑ `app/services/message_queue.py` - –û—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –£–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ—Ç–æ–∫–æ–º —Å–æ–æ–±—â–µ–Ω–∏–π, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∞–º —é–∑–µ—Ä—É

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –æ–¥–Ω–æ
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫—É –ò–ò
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### ‚öôÔ∏è `app/config.py` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
**–ß—Ç–æ —Å–æ–¥–µ—Ä–∂–∏—Ç:**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ò–ò
- –†–∞–±–æ—á–∏–µ —á–∞—Å—ã —Å–∞–ª–æ–Ω–∞
- –°–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ –∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤

### üóÑÔ∏è `app/database.py` - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
**–¢–∞–±–ª–∏—Ü—ã:**
- `projects` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤
- `bookings` - –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤  
- `message_queue` - –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π
- `dialogues` - –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–æ–≤
- `feedback` - –æ—Ç–∑—ã–≤—ã –∫–ª–∏–µ–Ω—Ç–æ–≤

### üí¨ `prompts.yml` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–æ–¥–∞
**–°–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–º—Ç—ã –¥–ª—è –∫–ª–æ–¥–∞. –í–ê–ñ–ù–û: –Ω–µ –∏–∑–º–µ–Ω—è—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –ø—Ä–æ–º—Ç—ã**

---

## üìä –ö–∞–∫ —á–∏—Ç–∞—Ç—å –ª–æ–≥–∏

### üìç –ì–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ª–æ–≥–∏

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª `app.log` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å (journalctl -u cosmetology-bot -f)

### üîç –¢–∏–ø—ã –ª–æ–≥–æ–≤

#### ‚úÖ INFO - –û–±—ã—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞
```
2025-01-20 14:30:15 - Message ABC123 get UUID: DEF456
2025-01-20 14:30:16 - Message ID: DEF456 - Processing incoming message through queue service
```

#### ‚ö†Ô∏è WARNING - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
```
2025-01-20 14:30:17 - Message ID: DEF456 - Failed to parse date '32.13': Invalid date format
```

#### ‚ùå ERROR - –û—à–∏–±–∫–∏
```
2025-01-20 14:30:18 - Message ID: DEF456 - Claude API error: API rate limit exceeded
```

### üîé –ö–∞–∫ –Ω–∞–π—Ç–∏ –ø—Ä–æ–±–ª–µ–º—É

1. **–ù–∞–π–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –æ—à–∏–±–∫–æ–π**, –∫–∞–∂–¥–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é, –∫–æ–≥–¥–∞ –æ–Ω–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ –ø—Ä–æ–µ–∫—Ç, –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∞–π–¥–∏
2. **–ü—Ä–æ—Å–ª–µ–¥–∏—Ç–µ –≤–µ—Å—å –ø—É—Ç—å** —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ Message ID
3. **–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ ERROR –∏ WARNING**, –µ—Å–ª–∏ –Ω–µ—Ç - –Ω–∞ –¥–µ—Ç–∞–ª–∏ –ª–æ–≥–æ–≤.

#### –ü—Ä–∏–º–µ—Ä –∞–Ω–∞–ª–∏–∑–∞ –ª–æ–≥–∞:
```
# –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏—à–ª–æ
14:30:15 - Message "–•–æ—á—É –∑–∞–ø–∏—Å–∞—Ç—å—Å—è" get UUID: ABC123

# –ù–∞—á–∞–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫—É
14:30:16 - Message ID: ABC123 - Processing incoming message

# –ê–Ω–∞–ª–∏–∑ –ö–ª–æ–¥–∞
14:30:17 - Message ID: ABC123 - Starting intent detection

# –û—à–∏–±–∫–∞ –≤ –ö–ª–æ–¥–µ
14:30:18 - Message ID: ABC123 - Error in intent detection: API timeout

# –†–µ–∑—É–ª—å—Ç–∞—Ç
14:30:19 - Message ID: ABC123 - Returning error response
```

### üö® –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

#### 1. "Claude API error: API rate limit exceeded"
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ò–ò  
**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–¥–æ–∂–¥–∏—Ç–µ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤—Ç–æ—Ä–æ–π API –∫–ª—é—á

#### 2. "Database connection failed"
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–ø—É—â–µ–Ω –ª–∏ PostgreSQL, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —É–∫–∞–∑–∞–Ω username:password, —Å–æ–∑–¥–∞–Ω–∞ –ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö.

#### 3. "Redis connection failed"
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis  
**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ Redis —Å–µ—Ä–≤–µ—Ä

#### 4. "Google Sheets access denied"
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Google API
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª credentials.json, ID —Ç–∞–±–ª–∏—Ü—ã –∏ –¥–æ–±–∞–≤–ª–µ–Ω –ª–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –≤ —Ç–∞–±–ª–∏—Ü—É –∫–∞–∫ –†–µ–¥–∞–∫—Ç–æ—Ä

---

## üß™ –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É (–õ–û–ö–ê–õ–¨–ù–û)

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—Å–∫–∞

```bash
python start.py

# –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
‚úÖ All required environment variables are set
‚úÖ Database tables created successfully
‚úÖ Database connection successful
‚úÖ Redis connection successful
‚úÖ Claude API key configured
üöÄ Starting application on 0.0.0.0:8000
```

### –ò–õ–ò (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–µ–µ)

```bash
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000/docs –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã:
- **GET** `/health` - –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å `{"status": "healthy"}`

#### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
- **GET** `/projects/default/stats` - –ø–æ–∫–∞–∂–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∑–∞–ø–∏—Å–µ–π

## üß™ –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É (–ù–ê –°–ï–†–í–ï–†–ï)

### 1. –ß–µ—Ä–µ–∑ linux-service

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞.**
`systemctl list-units --type=service`
**–ù–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è, –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å–µ—Ä–≤–∏—Å –∏–º–µ–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ `cosmetology-bot.service`**
**–ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –Ω–µ —Å–æ–∑–¥–∞–Ω - —Å–æ–∑–¥–∞—Ç—å –µ–≥–æ**
```bash
sudo nano /etc/systemd/system/cosmetology-bot.service

### –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ —Å —Å–µ—Ä–≤–∏—Å–æ–º:
[Unit]
Description=Cosmetology Bot Backend
After=network.target

[Service]
User=root
WorkingDirectory=/root/cosmetology-bot-backend
ExecStart=/root/cosmetology-bot-backend/.venv/bin/uvicorn main:app --host 0.0.0.0 --port 8001
Restart=always
RestartSec=5
Environment=PYTHONUNBUFFERED=1

[Install]
WantedBy=multi-user.target
```

```bash
# Reload systemd to recognize new service
sudo systemctl daemon-reload

# Enable service (start at boot)
sudo systemctl enable cosmetology-bot

# Start the service
sudo systemctl start cosmetology-bot

# Check service status
sudo systemctl status cosmetology-bot
```

**–î–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–≤ —Å–ª—É—á–∞–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π)**
```bash
sudo systemctl restart cosmetology-bot

## OR

sudo systemctl stop cosmetology-bot
sudo systemctl start cosmetology-bot
```

## 2. –í—Ä—É—á–Ω—É—é

**–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ**
```bash
cd cosmetology-bot-backend
source .venv/bin/activate
```

**–¢–µ–ø–µ—Ä—å –∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–µ–∫—Ç (–±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω –ø–æ–∫–∞ –º—ã –µ–≥–æ –¥–µ—Ä–∂–∏–º –∑–∞–ø—É—â–µ–Ω–Ω—ã–º —Ä—É–∫–∞–º–∏, –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ –±–µ–∫–≥—Ä–∞—É–Ω–¥–µ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å linux-service)**
`uvicorn main:app --host 0.0.0.0 --port 8000 --reload`

**–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ - `CTRL+C`**


---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Å–ª—É–≥ –∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤
TBD: –ø–µ—Ä–µ–Ω–æ—à—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Claude
**–í —Ñ–∞–π–ª–µ `.env`** 
```bash
# Claude AI Configuration
CLAUDE_API_KEY_1=your_claude_api_key_1_here
CLAUDE_API_KEY_2=your_claude_api_key_2_here
CLAUDE_MODEL=claude-sonnet-4-20250514
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–º—Ç–æ–≤

**–í —Ñ–∞–π–ª–µ `prompts.yml` –∏–∑–º–µ–Ω—è—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ–º—Ç—ã. –ú–µ–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –Ω–æ –Ω–µ –∏—Ö –∏–º—è.**

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google –¢–∞–±–ª–∏—Ü—ã

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞:

| A (–î–∞—Ç–∞) | B (–ü–æ–ª–Ω–∞—è –¥–∞—Ç–∞) | C (–í—Ä–µ–º—è) | D (ID –∫–ª–∏–µ–Ω—Ç–∞) | E (–ò–º—è) | F (–£—Å–ª—É–≥–∞) |
|----------|-----------------|-----------|----------------|---------|------------|
| 25.01    | 25.01.2025      | 14:00     | 123456789      | –ê–Ω–Ω–∞    | –ú–∞–Ω–∏–∫—é—Ä    |

**–í–∞–∂–Ω–æ:** 
- –£ –∫–∞–∂–¥–æ–≥–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏—Å—Ç
- –ù–∞–∑–≤–∞–Ω–∏—è –ª–∏—Å—Ç–æ–≤ –¥–æ–ª–∂–Ω—ã —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –∏–º–µ–Ω–∞–º–∏ –≤ –∫–æ–¥–µ
- –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Ç–∞–±–ª–∏—Ü–µ–π —Å email –∏–∑ Google Service Account
- –¢–∞–±–ª–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ (–ø–µ—Ä–≤—ã–µ 3 —Å—Ç–æ–ª–±—Ü–∞ - –î–∞—Ç–∞, –ø–æ–ª–Ω–∞—è –¥–∞—Ç–∞, –≤—Ä–µ–º—è)

---

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –°–∏—Å—Ç–µ–º–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Python:**
   ```bash
   python --version  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 3.8+
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
   ```bash
   # –í –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å (.venv)
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```bash
   pip list  # –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–∑ requirements.txt
   ```

### –ò–ò –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á–∏ Claude:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã –∏ –±–∞–ª–∞–Ω—Å
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–µ –∫–ª—é—á–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
   ```bash
   grep "Claude API error" app.log
   ```

### –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç Google –¢–∞–±–ª–∏—Ü—ã

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Service Account:**
   - –§–∞–π–ª `credentials.json` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
   - Email –∏–∑ —Ñ–∞–π–ª–∞ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –¥–æ—Å—Ç—É–ø –∫ —Ç–∞–±–ª–∏—Ü–µ
   - ID —Ç–∞–±–ª–∏—Ü—ã —É–∫–∞–∑–∞–Ω –≤–µ—Ä–Ω–æ

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ API:**
   - Google Sheets API –≤–∫–ª—é—á–µ–Ω
   - Google Drive API –≤–∫–ª—é—á–µ–Ω

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ PostgreSQL:**
   ```bash
   # Windows
   services.msc  # –ù–∞–π–¥–∏—Ç–µ PostgreSQL
   
   # Mac
   brew services list | grep postgresql
   
   # Linux
   sudo systemctl status postgresql
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**
   ```python
   from app.database import engine
   with engine.connect() as conn:
       result = conn.execute("SELECT 1")
       print("–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!")
   ```

### Telegram –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:**
   ```bash
   grep "Webhook received" app.log
   ```

---

### –†–µ–ø–æ—Ä—Ç –±–∞–≥–æ–≤

–ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –±–∞–≥–æ–≤ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ:
1. **–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏** –∏–∑ `app.log` (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–ø—Ä–æ–≤–æ—Ü–∏—Ä–æ–≤–∞–ª–∏ –±–∞–≥) **–ª–∏–±–æ Message ID, —Å –∫–æ—Ç–æ—Ä—ã–º —Å–ª—É—á–∏–ª—Å—è –±–∞–≥**
3. **–û–ø–∏—Å–∞–Ω–∏–µ –±–∞–≥–∞**
4. **–®–∞–≥–∏ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

### –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å GitHub

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω) (Ctrl+C)

# –ü–æ–ª—É—á–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
git pull origin main

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –û–±–Ω–æ–≤–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
python -c "from app.database import create_tables; create_tables()"

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```
